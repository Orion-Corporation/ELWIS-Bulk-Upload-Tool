#:import Factory kivy.factory.Factory

<CustomSpinnerOption@SpinnerOption>:
    font_size: '14sp'
    halign: 'left'
    text_size: self.width, None
    size_hint_y: None
    height: self.texture_size[1]

BoxLayout:
    orientation: 'horizontal'
    padding: [10, 10, 10, 10]
    spacing: 10
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            size: self.size
            pos: self.pos

    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.25  # Adjusted to make the left column narrower
        spacing: 10

        Label:
            id: label
            text: "Select SDF Files to Process"
            font_size: '20sp'
            color: [0, 0, 0, 1]
            size_hint_y: None
            height: '40dp'

        Spinner:
            id: param_spinner
            text: 'Select Parameter Set'
            size_hint_y: None
            height: '48dp'
            option_cls: 'CustomSpinnerOption'  # Use the custom option class

        Button:
            id: button_select
            text: "Choose Files"
            background_normal: ''
            background_color: [0, 0.14, 0.29, 1]
            color: [1, 1, 1, 1]
            size_hint_y: None
            height: '48dp'

        Button:
            id: button_upload
            text: "Upload to API"
            background_normal: ''
            background_color: [0.04, 0.33, 0.64, 1]
            color: [1, 1, 1, 1]
            size_hint_y: None
            height: '48dp'
            disabled: True

        Button:
            id: button_stop_upload
            text: "Stop Upload"
            background_normal: ''
            background_color: [1, 0, 0, 1]
            color: [1, 1, 1, 1]
            size_hint_y: None
            height: '48dp'
            disabled: True  # Initially disabled

        Button:
            id: button_readme
            text: "README"
            background_normal: ''
            background_color: [0.5, 0.5, 0.5, 1]
            color: [1, 1, 1, 1]
            size_hint_y: None
            height: '48dp'

        Button:
            id: button_clear_folders
            text: "Clear Output Folders"
            background_normal: ''
            background_color: [0.5, 0.5, 0.5, 1]
            color: [1, 1, 1, 1]
            size_hint_y: None
            height: '48dp'

        ProgressBar:
            id: progress_bar
            max: 100
            value: 0
            size_hint_y: None
            height: '20dp'

    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.75  # Adjusted to make the right column wider
        padding: [0, 0, 0, 0]
        spacing: 10

        TabbedPanel:
            do_default_tab: False

            TabbedPanelItem:
                text: 'Selected Files'
                ScrollView:
                    size_hint: (1, 1)
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    GridLayout:
                        id: file_list
                        cols: 1
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: 10

            TabbedPanelItem:
                text: 'Terminal Output'
                BoxLayout:
                    orientation: 'vertical'
                    size_hint_y: 1  # Fill the entire vertical space
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            size: self.size
                            pos: self.pos

                    ScrollView:
                        size_hint_y: 1  # Fill the entire vertical space
                        TextInput:
                            id: terminal_output
                            text: ''
                            readonly: True
                            font_size: '14sp'
                            background_color: [0.9, 0.9, 0.9, 1]
                            foreground_color: [0, 0, 0, 1]
                            halign: 'left'
                            valign: 'top'
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.minimum_height
